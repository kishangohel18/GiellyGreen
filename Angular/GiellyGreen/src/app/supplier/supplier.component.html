<nz-layout class="layout">
  <nz-sider nzCollapsible nzBreakpoint="lg" [nzCollapsedWidth]="0">
    <div class="logo"><img src="/assets/innerLogoGolden.png" width="250" /></div>
    <ul nz-menu nzTheme="dark" nzMode="inline">
      <li nz-menu-item>
        <span class="menuItem" style="text-align: center;"><a routerLink="/monthly-invoice">MONTHLY INVOICE</a></span>
      </li>
      <li nz-menu-item>
        <span class="menuItem"><a routerLink="/supplier"></a>SUPPLIERS LIST</span>
      </li>
    </ul>
  </nz-sider>
  <nz-layout>
    <nz-content>
      <div class="inner-content">
        <div class="row p-2">
          <div class="col-md-5 supplierTitle">
            Suppliers List
          </div>
          <div class="col-md-5">
                <nz-form-control nzErrorTip="Please input your username!">
                  <nz-input-group nzPrefixIcon="search">
                    <input [(ngModel)]="searchText" (keyup)="searchSupplier()" nz-input placeholder="Search here..." />
                  </nz-input-group>
                </nz-form-control>
          </div>
          <div class="col-md-2">
            <button nz-button class="addButton" (click)="showModalTop(null)" nzType="primary">
              <fa-icon [icon]="faPlus" class="px-2"></fa-icon>
              ADD SUPPLIER</button>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <!-- <div class="scrollableModal"> -->
              <div class="scrollableTable">
            <nz-table class="table text-center table-bordered" #apiProductsDataTable
              [nzData]="apiSuppliersData" [nzPageSize]="100">
              <thead>
                <tr>
                  <th style="border-radius: 6px 0px 0px 0px;" scope="col" [nzSortFn]="sortRefFn">Supplier Reference</th>
                  <th scope="col" [nzSortFn]="sortNameFn">Supplier Name</th>
                  <th scope="col">Status</th>
                  <th style="border-radius: 0px 6px 0px 0px;" scope="col">Action</th>
                </tr>
              </thead>
              <!-- <div class="scrollableTable"> -->
              <tbody>
                
                <tr *ngFor="let data of apiProductsDataTable.data">
                  <td scope="row">{{data.ReferenceNumber}}</td>
                  <td>{{data.SupplierName}}</td>
                  <td><nz-switch class="ant-switch-ch" [(ngModel)]="data.IsActive" (ngModelChange)="changeStatus(data,data.IsActive)"></nz-switch>
                  </td>
                  <td>
                    <fa-icon [icon]="faPen" class="p-2" (click)="showModalTop(data)"></fa-icon>
                    <fa-icon [icon]="faTrash" (click)="onDeleteProduct(data)"></fa-icon>
                  </td>
                </tr>
              </tbody>
              
            <!-- </div> -->
            </nz-table>
          </div>
            
          <!-- </div> -->
          </div>
        </div>
        <nz-modal [(nzVisible)]="isVisibleTop" nzTitle="Add New Supplier" (nzOnCancel)="handleCancelTop()"
          (nzOnOk)="handleOkTop()" [nzStyle]="{ top: '30px'}" [nzFooter]="modalFooter" [nzWidth]="600">
          <ng-container *nzModalContent nzBodyStyle="height:500">
            <form nz-form [formGroup]="validateForm">
              <div class="scrollableModal">
                <div nz-row>
                  <div nz-col nzSpan="12" class="pr">
                    <nz-form-item>
                      <nz-form-control nzValidatingTip="Validating..." [nzErrorTip]="supplierNameError">
                        <label>Supplier Name</label><br>
                        <input nz-input formControlName="supplierName"/>
                        <ng-template #supplierNameError let-control>
                          <ng-container *ngIf="control.hasError('required')">Enter Supplier Name</ng-container>
                          <ng-container *ngIf="control.hasError('pattern')">Supplier name must consist only alphabtes!
                          </ng-container>
                        </ng-template>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                  <div nz-col nzSpan="12">
                    <nz-form-item>
                      <nz-form-control [nzErrorTip]="supplierReferenceError">
                        <label>Supplier Reference</label><br>
                        <input nz-input formControlName="supplierReference"/>
                        <ng-template #supplierReferenceError let-control>
                          <ng-container *ngIf="control.hasError('required')">Enter Supplier Reference</ng-container>
                          <ng-container *ngIf="control.hasError('pattern')">Supplier Reference must consist maximum 15
                            letters!
                          </ng-container>
                        </ng-template>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="24">
                    <nz-form-item>
                      <nz-form-control [nzErrorTip]="businessAddressError">
                        <label>Business Address</label>
                        <textarea formControlName="businessAddress" nz-input rows="3"></textarea>
                        <ng-template #businessAddressError let-control>
                          <ng-container *ngIf="control.hasError('required')">Enter Business Address</ng-container>
                          <ng-container *ngIf="control.hasError('pattern')">Business Address must consist at least 3 and
                            maximum 150 letters!</ng-container>
                        </ng-template>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="12" class="pr">
                    <nz-form-item>
                      <nz-form-control nzValidatingTip="Validating..." [nzErrorTip]="emailAddressError">
                        <label>Email Address</label>
                        <input nz-input formControlName="emailAddress" name="fname"/>
                        <ng-template #emailAddressError let-control>
                          <ng-container *ngIf="control.hasError('required')">Enter Email Address</ng-container>
                          <ng-container *ngIf="control.hasError('email')">Enter valid email address!
                          </ng-container>
                        </ng-template>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                  <div nz-col nzSpan="12">
                    <nz-form-item>
                      <nz-form-control [nzErrorTip]="phoneNumberError">
                        <label>Phone Number</label>
                        <input nz-input formControlName="phoneNumber" name="fname" />
                        <ng-template #phoneNumberError let-control>
                          <ng-container *ngIf="control.hasError('pattern')">
                            Enter valid phone number!
                          </ng-container>
                        </ng-template>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="12" class="pr">
                    <nz-form-item>
                      <nz-form-control nzValidatingTip="Validating..." [nzErrorTip]="companyRegisteredNumberError">
                        <label>Company Registered Number</label>
                        <input nz-input formControlName="companyRegisteredNumber" name="fname"/>
                        <ng-template #companyRegisteredNumberError let-control>
                          <ng-container *ngIf="control.hasError('pattern')">Number must consist only numbers with the
                            limit of 15!
                          </ng-container>
                        </ng-template>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                  <div nz-col nzSpan="12">
                    <nz-form-item>
                      <nz-form-control [nzErrorTip]="VATNumberError">
                        <label>VAT Number</label>
                        <input nz-input formControlName="VATNumber" name="fname"/>
                        <ng-template #VATNumberError let-control>
                          <ng-container *ngIf="control.hasError('pattern')">Number must consist only numbers with the
                            limit of 15!</ng-container>
                        </ng-template>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="24">
                    <nz-form-item>
                      <nz-form-control [nzErrorTip]="taxReferenceError">
                        <label>Tax Reference</label>
                        <input formControlName="taxReference" nz-input />
                        <ng-template #taxReferenceError let-control>
                          <ng-container *ngIf="control.hasError('pattern')">Reference must consist maximum 15 letters
                          </ng-container>
                        </ng-template>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="24">
                    <nz-form-item>
                      <nz-form-control [nzErrorTip]="companyRegisteredAddressError">
                        <label>Company Registered Address</label>
                        <textarea formControlName="companyRegisteredAddress" nz-input rows="3"></textarea>
                        <ng-template #companyRegisteredAddressError let-control>
                          <ng-container *ngIf="control.hasError('pattern')">Address must consist at least 3 and
                            maximum 100 letters</ng-container>
                        </ng-template>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="12" class="pr">
                    <nz-form-item>
                      <nz-form-control nzValidatingTip="Validating...">
                        <label>Upload Invoice Logo</label>
                        <div class="clearfix">
                          <input nz-input type="file" 
                            accept="image/png,image/jpeg" #fileUpload (change)="UploadLogo($event)" hidden/>
                            <button nz-button (click)="fileUpload.click()">
                              <i nz-icon nzType="upload"></i>
                              Upload
                            </button>
                        </div>
                        <div *ngIf="file">
                          {{file.name}}
                          <img [src]="uploadedSupplierLogo" height="200" width="200">
                        </div>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                  <div nz-col nzSpan="12">
                    <nz-form-item>
                      <label>Is Active ?</label>
                      <nz-form-control>
                        <nz-switch formControlName="activeSupplier"></nz-switch>
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                </div>
              </div>
            </form>
          </ng-container>
        </nz-modal>

      </div>
    </nz-content>
    <ng-template #modalFooter>
      <button nz-button class="darkButtonModal" nzType="default" (click)="handleOkTop()">Save</button>
      <button nz-button nzType="primary" (click)="handleCancelTop()" class="cancelButtonModal">Cancel</button>
    </ng-template>
    <!-- <nz-footer>Ant Design ©2020 Implement By Angular</nz-footer> -->
  </nz-layout>
</nz-layout>